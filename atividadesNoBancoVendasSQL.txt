/* Exercício 1 */
UPDATE DEBITOS d
SET d.SITUACAO_DEBITO = 'Atrasado'
WHERE d.SITUACAO_DEBITO = 'Pendente' AND d.DATAVENCIMENTO < CURRENT_DATE 

/* Exercício 2 */
UPDATE DEBITOS d
SET d.SITUACAO_DEBITO = 'Pendente'
WHERE d.SITUACAO_DEBITO <> 'Pago' AND d.DATAVENCIMENTO >= CURRENT_DATE

/* Exercício 3 */
UPDATE DEBITOS d
SET d.DATAVENCIMENTO = DATEADD(5 YEAR TO d.DATAVENCIMENTO) 
WHERE d.SITUACAO_DEBITO = 'Negociado'

/* Exercício 4 */
SELECT p.NOME, p.EMAIL, p.TELEFONE FROM PESSOA p

/* Exercício 5 */
SELECT p.PRECO_UNITARIO FROM PRODUTO p 
WHERE p.PRECO_UNITARIO > 100

/* Exercício 6 */
SELECT * FROM VENDA v
WHERE v.DATA_VENDA = '2022-06-23'

/* Exercício 7 */
SELECT p.DATA_NASCIMENTO,
       p.NOME,
       2024 - EXTRACT(YEAR FROM p.DATA_NASCIMENTO) AS IDADE
FROM PESSOA p 
WHERE p.ID_PESSOA IN (
SELECT f.ID_PESSOA 
FROM FORNECEDOR f 
WHERE f.ID_FORNECEDOR NOT IN (
SELECT p2.ID_FORNECEDOR 
FROM PRODUTO p2
)
)

/* Exercício 8 */
/* Observação: estou vendo se possui compras realizadas e tem débito atrasado,
   não se fez compras enquanto tinha o débito atrasado
 */
SELECT * FROM CLIENTE c 
WHERE c.ID_CLIENTE IN (SELECT d.ID_CLIENTE FROM DEBITOS d WHERE d.DATAVENCIMENTO < CURRENT_DATE)
AND c.ID_Cliente IN (SELECT P.ID_CLIENTE FROM PAGAMENTO p)

/* o 9 foi pulado porque necessita de uma tabela que não foi criada */

/* Exercício 10 */
SELECT p.NOME
,p.ID_PESSOA
,2024 - EXTRACT(YEAR FROM p.DATA_NASCIMENTO) AS IDADE
,SUM(p2.VALOR_DEBITO) AS SOMA_DEBITOS
,SUM(p2.VALOR_PAGO) AS SOMA_PAGO
FROM PESSOA p
JOIN CLIENTE c ON p.ID_PESSOA = c.ID_PESSOA
JOIN PAGAMENTO p2 ON c.ID_CLIENTE = p2.ID_CLIENTE
WHERE p.ID_PESSOA IN (SELECT c.ID_PESSOA FROM CLIENTE c WHERE c.ID_CLIENTE IN (SELECT p2.ID_CLIENTE FROM PAGAMENTO p2))
GROUP BY p.NOME, p.ID_PESSOA, p.DATA_NASCIMENTO
ORDER BY SOMA_DEBITOS DESC
ROWS 1 TO 10


/* 12 também foi pulada */
/* ATIVIDADE AINDA INCOMPLETA!!!!!!!! */